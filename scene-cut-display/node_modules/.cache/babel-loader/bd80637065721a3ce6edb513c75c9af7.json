{"ast":null,"code":"var _jsxFileName = \"/Users/mngyuan/git/gid/video-editing-experiments/scene-cut-display/scene-cut-display/src/App.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { useEffect, useState } from 'react';\nimport { useMeasure } from 'react-use';\nimport * as Papa from 'papaparse';\nimport './App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst lastFrame = sceneData[sceneData.length - 1]['End Frame'];\n\nconst findScene = percent => {\n  const frameNeedle = Math.round(percent * lastFrame);\n\n  for (const scene of sceneData) {\n    if (frameNeedle <= scene['End Frame'] && frameNeedle >= scene['Start Frame']) {\n      return scene;\n    }\n  }\n};\n\nconst Filmstrip = () => {\n  _s();\n\n  const [ref, {\n    width,\n    height\n  }] = useMeasure(); // 1=whole film, 0=frame by frame\n\n  const zoomLevel = 1;\n  const frameheight = 100;\n  const frameaspectratio = 1912 / 1032;\n  const framewidth = frameheight * frameaspectratio;\n  const framesonstrip = Math.floor(width / framewidth);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: ref,\n    children: [...Array(framesonstrip).keys()].map(i => /*#__PURE__*/_jsxDEV(\"img\", {\n      src: `/assets/drivemycar/sceneimages/${findScene(1 / framesonstrip * i)['Scene Number'].padStart(3, '0')}.jpg`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 9\n    }, this))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 30,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Filmstrip, \"UDdfYXvoyIMMMZL2peE+OYo06mo=\", false, function () {\n  return [useMeasure];\n});\n\n_c = Filmstrip;\n\nfunction App() {\n  _s2();\n\n  useEffect(() => {\n    async function fetchCSV() {\n      const resp = await fetch(`${process.env.PUBLIC_URL}/drivemycar/drivemycarscenes.csv`);\n      const rawcsv = await resp.text();\n      const sceneCSV = Papa.parse(rawcsv, {\n        header: true\n      }); // papaparse results in the last object being empty, not sure why\n\n      const sceneData = sceneCSV.data.slice(0, sceneCSV.data.length - 1);\n    }\n\n    fetchCSV();\n  }, []);\n  useEffect(() => {\n    async function fetchImages() {\n      // fetch all scene images\n      await Promise.all(sceneData.map(scene => fetch(`${process.env.PUBLIC_URL}/drivemycar/sceneimages/${scene['Scene Number'].padStart(3, '0')}.jpg`)));\n    }\n\n    fetchImages();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 10\n  }, this);\n}\n\n_s2(App, \"3ubReDTFssvu4DHeldAg55cW/CI=\");\n\n_c2 = App;\nexport default App;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Filmstrip\");\n$RefreshReg$(_c2, \"App\");","map":{"version":3,"sources":["/Users/mngyuan/git/gid/video-editing-experiments/scene-cut-display/scene-cut-display/src/App.js"],"names":["useEffect","useState","useMeasure","Papa","lastFrame","sceneData","length","findScene","percent","frameNeedle","Math","round","scene","Filmstrip","ref","width","height","zoomLevel","frameheight","frameaspectratio","framewidth","framesonstrip","floor","Array","keys","map","i","padStart","App","fetchCSV","resp","fetch","process","env","PUBLIC_URL","rawcsv","text","sceneCSV","parse","header","data","slice","fetchImages","Promise","all"],"mappings":"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","sourcesContent":["import {useEffect, useState} from 'react';\nimport {useMeasure} from 'react-use';\nimport * as Papa from 'papaparse';\n\nimport './App.css';\n\nconst lastFrame = sceneData[sceneData.length - 1]['End Frame'];\nconst findScene = (percent) => {\n  const frameNeedle = Math.round(percent * lastFrame);\n  for (const scene of sceneData) {\n    if (\n      frameNeedle <= scene['End Frame'] &&\n      frameNeedle >= scene['Start Frame']\n    ) {\n      return scene;\n    }\n  }\n};\n\nconst Filmstrip = () => {\n  const [ref, {width, height}] = useMeasure();\n  // 1=whole film, 0=frame by frame\n  const zoomLevel = 1;\n  const frameheight = 100;\n  const frameaspectratio = 1912 / 1032;\n  const framewidth = frameheight * frameaspectratio;\n  const framesonstrip = Math.floor(width / framewidth);\n\n  return (\n    <div ref={ref}>\n      {[...Array(framesonstrip).keys()].map((i) => (\n        <img\n          src={`/assets/drivemycar/sceneimages/${findScene(\n            (1 / framesonstrip) * i,\n          )['Scene Number'].padStart(3, '0')}.jpg`}\n        />\n      ))}\n    </div>\n  );\n};\n\nfunction App() {\n  useEffect(() => {\n    async function fetchCSV() {\n      const resp = await fetch(\n        `${process.env.PUBLIC_URL}/drivemycar/drivemycarscenes.csv`,\n      );\n      const rawcsv = await resp.text();\n      const sceneCSV = Papa.parse(rawcsv, {header: true});\n      // papaparse results in the last object being empty, not sure why\n      const sceneData = sceneCSV.data.slice(0, sceneCSV.data.length - 1);\n    }\n    fetchCSV();\n  }, []);\n\n  useEffect(() => {\n    async function fetchImages() {\n      // fetch all scene images\n      await Promise.all(\n        sceneData.map((scene) =>\n          fetch(\n            `${process.env.PUBLIC_URL}/drivemycar/sceneimages/${scene[\n              'Scene Number'\n            ].padStart(3, '0')}.jpg`,\n          ),\n        ),\n      );\n    }\n    fetchImages();\n  }, []);\n\n  return <div className=\"App\"></div>;\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}